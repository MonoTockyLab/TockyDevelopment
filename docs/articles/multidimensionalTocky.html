<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<title>Introduction to TockyDevelopment • TockyDevelopment</title>
<script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet">
<link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet">
<script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Introduction to TockyDevelopment">
<meta name="google-site-verification" content="Pj4WWF5m9cqCcPqkGG75BI1_593zXImuFRpI8TnAous">
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-light" data-bs-theme="light" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">TockyDevelopment</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.1.0</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="active nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-articles" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Articles</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-articles">
<li><a class="dropdown-item" href="../articles/multidimensionalTocky.html">Introduction to TockyDevelopment</a></li>
  </ul>
</li>
      </ul>
<ul class="navbar-nav">
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/MonoTockyLab/TockyDevelopment/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
<li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json">
</form></li>
      </ul>
</div>


  </div>
</nav><div class="container template-article">




<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">

      <h1>Introduction to TockyDevelopment</h1>
                        <h4 data-toc-skip class="author">Dr. Masahiro
Ono</h4>
            
            <h4 data-toc-skip class="date">2024-06-20</h4>
      
      <small class="dont-index">Source: <a href="https://github.com/MonoTockyLab/TockyDevelopment/blob/HEAD/vignettes/multidimensionalTocky.Rmd" class="external-link"><code>vignettes/multidimensionalTocky.Rmd</code></a></small>
      <div class="d-none name"><code>multidimensionalTocky.Rmd</code></div>
    </div>

    
    
<p><img src="assets/ButterflyDevelopment.png" width="80%"></p>
<div class="section level3">
<h3 id="introduction">Introduction<a class="anchor" aria-label="anchor" href="#introduction"></a>
</h3>
<p>The <strong>TockyDevelopment</strong> package (<span class="citation">Ono &amp; Crompton (<a href="#ref-Ono2024TockyDevelopment">2024</a>)</span>) provides an
integrated workflow for studies in developmental cell biology and
related areas, including thymus biology. It enables balanced analysis of
multidimensional marker expression data (marker profiles) and Timer
fluorescence, revealing temporal dynamics of developing cells and
identifying temporal developmental trajectories in a data-oriented
manner.</p>
<p>In this vignette, we will guide you through the key steps of the
TockyDevelopment analysis pipeline:</p>
<ol style="list-style-type: decimal">
<li>Data Preprocessing</li>
<li>Precision PCA and Clustering</li>
<li>Cluster Feature Analysis and Group Statistics</li>
<li>Tocky Canonical Correspondence Analysis (Tocky-CCA)</li>
<li>Tocky Network Analysis</li>
<li>Dijkstra-Tocky Pathfinding</li>
</ol>
</div>
<div class="section level3">
<h3 id="data-preprocessing">1. Data preprocessing<a class="anchor" aria-label="anchor" href="#data-preprocessing"></a>
</h3>
<p>Follow manual pages for the TockyPrep package to <a href="https://monotockylab.github.io/TockyPrep/articles/TockyDataPreprocessing.html" class="external-link">create
a TockyPrepData object</a>, performing necessary data preprocessing. In
addition, use the GatingTree package to apply <a href="https://monotockylab.github.io/GatingTree/articles/DefineNegatives.html" class="external-link"><code>DefineNegatives</code>
to determine the threshold values for markers to be analyzed</a>.</p>
<p>Read the following papers (<span class="citation">Ono (<a href="#ref-GatingTree2024">2024a</a>)</span>, <span class="citation">Ono
(<a href="#ref-TockyPrep2024">2024b</a>)</span>) for the principles of
TockyPrep and GatingTree.</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/MonoTockyLab/TockyPrep" class="external-link">TockyPrep</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/MonoTockyLab/GatingTree" class="external-link">GatingTree</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/MonoTockyLab/TockyDevelopment" class="external-link">TockyDevelopment</a></span><span class="op">)</span></span></code></pre></div>
<p>For detailed preprocessing steps, refer to the <a href="https://monotockylab.github.io/TockyPrep/articles/TockyDataPreprocessing.html" class="external-link">TockyPrep
documentation</a>.</p>
</div>
<div class="section level3">
<h3 id="precision-pca-and-clustering">2. Precision PCA and Clustering<a class="anchor" aria-label="anchor" href="#precision-pca-and-clustering"></a>
</h3>
<div class="section level4">
<h4 id="performing-pca">Performing PCA<a class="anchor" aria-label="anchor" href="#performing-pca"></a>
</h4>
<p>Assuming that you have successfully produced TockyPrepData, use the
<code>TockyPCA</code> function to perform Precision PCA:</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Perform Precision PCA on the TockyPrepData object</span></span>
<span><span class="va">x</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/TockyPCA.html">TockyPCA</a></span><span class="op">(</span><span class="va">x</span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level4">
<h4 id="clustering-cells">Clustering Cells<a class="anchor" aria-label="anchor" href="#clustering-cells"></a>
</h4>
<p>Cluster the cells using <code>TockyClustering</code>:</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Cluster cells into a desired number of clusters</span></span>
<span><span class="va">x</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/TockyClustering.html">TockyClustering</a></span><span class="op">(</span><span class="va">x</span>, num_centre <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level4">
<h4 id="visualizing-clustering-results">Visualizing Clustering Results<a class="anchor" aria-label="anchor" href="#visualizing-clustering-results"></a>
</h4>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Plot clusters in the PCA space</span></span>
<span><span class="fu"><a href="../reference/PlotTockyClustering.html">PlotTockyClustering</a></span><span class="op">(</span><span class="va">x</span><span class="op">)</span></span></code></pre></div>
<p><img src="assets/tockyclustering.jpg" width="70%"></p>
<p><strong>Figure 1:</strong> Clustering results displayed in the PCA
space.</p>
</div>
</div>
<div class="section level3">
<h3 id="cluster-feature-analysis-and-group-statistics">3. Cluster Feature Analysis and Group Statistics<a class="anchor" aria-label="anchor" href="#cluster-feature-analysis-and-group-statistics"></a>
</h3>
<p>Analyze cluster features and group statistics to understand the
characteristics of each cluster.</p>
<div class="section level4">
<h4 id="visualizing-cluster-percentages">Visualizing Cluster Percentages<a class="anchor" aria-label="anchor" href="#visualizing-cluster-percentages"></a>
</h4>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Plot the percentage of each cluster within the sample</span></span>
<span><span class="fu"><a href="../reference/PlotClusterPercentage.html">PlotClusterPercentage</a></span><span class="op">(</span><span class="va">x</span><span class="op">)</span></span></code></pre></div>
<p><img src="assets/PlotClusterPercentages.jpg" width="75%"></p>
<p><strong>Figure 2:</strong> Percentage of cells in each cluster.</p>
</div>
</div>
<div class="section level3">
<h3 id="tocky-canonical-correspondence-analysis">4. Tocky Canonical Correspondence Analysis<a class="anchor" aria-label="anchor" href="#tocky-canonical-correspondence-analysis"></a>
</h3>
<p>Perform Tocky-CCA to integrate marker profiles and Timer
progression.</p>
<div class="section level4">
<h4 id="performing-tocky-cca">Performing Tocky-CCA<a class="anchor" aria-label="anchor" href="#performing-tocky-cca"></a>
</h4>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Perform Tocky-CCA on the data</span></span>
<span><span class="va">x</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/TockyCCA.html">TockyCCA</a></span><span class="op">(</span><span class="va">x</span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level4">
<h4 id="visualizing-tocky-cca-results">Visualizing Tocky-CCA Results<a class="anchor" aria-label="anchor" href="#visualizing-tocky-cca-results"></a>
</h4>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Generate a biplot of Tocky-CCA results</span></span>
<span><span class="fu"><a href="../reference/BiplotCCA.html">BiplotCCA</a></span><span class="op">(</span><span class="va">x</span><span class="op">)</span></span></code></pre></div>
<p><img src="assets/BiplotCCA.jpg" width="80%"></p>
<p><strong>Figure 3:</strong> Biplot of Tocky-CCA results.</p>
</div>
</div>
<div class="section level3">
<h3 id="tocky-network-analysis">5. Tocky Network Analysis<a class="anchor" aria-label="anchor" href="#tocky-network-analysis"></a>
</h3>
<p>Construct and visualize the Tocky network to analyze relationships
between clusters.</p>
<div class="section level4">
<h4 id="constructing-the-network">Constructing the Network<a class="anchor" aria-label="anchor" href="#constructing-the-network"></a>
</h4>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Construct the Tocky network</span></span>
<span><span class="va">x</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/TockyNetwork.html">TockyNetwork</a></span><span class="op">(</span><span class="va">x</span>, cut_off <span class="op">=</span> <span class="fl">0.2</span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level4">
<h4 id="visualizing-the-network">Visualizing the Network<a class="anchor" aria-label="anchor" href="#visualizing-the-network"></a>
</h4>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Plot the Tocky network</span></span>
<span><span class="fu"><a href="../reference/PlotTockyNetwork.html">PlotTockyNetwork</a></span><span class="op">(</span><span class="va">x</span><span class="op">)</span></span></code></pre></div>
<p><img src="assets/PlotTockyNetwork.jpg" width="80%"></p>
<p><strong>Figure 4:</strong> Visualization of the Tocky network.</p>
</div>
</div>
<div class="section level3">
<h3 id="dijkstra-tocky-pathfinding">6. Dijkstra-Tocky Pathfinding<a class="anchor" aria-label="anchor" href="#dijkstra-tocky-pathfinding"></a>
</h3>
<p>Identify developmental trajectories using the Dijkstra-Tocky
Pathfinding algorithm.</p>
<div class="section level4">
<h4 id="finding-developmental-paths">Finding Developmental Paths<a class="anchor" aria-label="anchor" href="#finding-developmental-paths"></a>
</h4>
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Perform pathfinding between specified clusters</span></span>
<span><span class="va">x</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/DijkstraTockyPath.html">DijkstraTockyPath</a></span><span class="op">(</span><span class="va">x</span>, origin_node <span class="op">=</span> <span class="st">'18'</span>, destination_node <span class="op">=</span> <span class="st">'19'</span><span class="op">)</span></span></code></pre></div>
<p><img src="assets/anglepath.jpg" width="40%"></p>
<p><strong>Figure 5:</strong> Identified developmental path from Cluster
18 to Cluster 19.</p>
<p><img src="assets/TockyDevelopment_logo.jpg" width="80%"></p>
<p><img src="assets/MonoLab.jpg" width="40%"></p>
</div>
</div>
<div class="section level2">
<h2 class="unnumbered" id="references">References<a class="anchor" aria-label="anchor" href="#references"></a>
</h2>
<div id="refs" class="references csl-bib-body hanging-indent" line-spacing="2">
<div id="ref-GatingTree2024" class="csl-entry">
Ono, M. (2024a). <em>GatingTree: Pathfinding analysis of group-specific
effects in cytometry data</em>. <a href="https://arxiv.org/abs/2411.00129" class="external-link">https://arxiv.org/abs/2411.00129</a>
</div>
<div id="ref-TockyPrep2024" class="csl-entry">
Ono, M. (2024b). <em>TockyPrep: Data preprocessing methods for flow
cytometric fluorescent timer analysis</em>. <a href="https://arxiv.org/abs/2411.04111" class="external-link">https://arxiv.org/abs/2411.04111</a>
</div>
<div id="ref-Ono2024TockyDevelopment" class="csl-entry">
Ono, M., &amp; Crompton, T. (2024). A multidimensional toolkit for
elucidating temporal trajectories in cell development in vivo.
<em>Development</em>.
</div>
</div>
</div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside>
</div>



    <footer><div class="pkgdown-footer-left">
  <p>Developed by Masahiro Ono.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.0.</p>
</div>

    </footer>
</div>





  </body>
</html>
